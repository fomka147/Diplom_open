{% extends 'myapp/base.html' %}
{% load static %}

{% block title %}Каталог САПР{% endblock %}

{% block content %}
<main>
    <form method="get" class="search">
    <input type="text" name="q" placeholder="Поиск САПР..." value="{{ request.GET.q }}">
    <button type="submit">Найти</button>
</form>
    <h1>Каталог САПР-систем</h1>
    <div class="filter">
        <form method="get">
            <label for="category">Фильтр по категории:</label>
            <select name="category" id="category" onchange="this.form.submit()">
                <option value="">Все категории</option>
                {% for value, label in categories %}
                <option value="{{ value }}" {% if request.GET.category == value %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
        </form>
    </div>
    <div class="cad-list">
        {% for cad in cad_systems %}
        <div class="cad-item">
            {% if cad.image %}
            <img src="{{ cad.image.url }}" alt="{{ cad.name }}">
            {% endif %}
            <h3>{{ cad.name }}</h3>
            <p>Производитель: {{ cad.manufacturer }}</p>
            <p>категория: {{ cad.get_category_display }}</p>
            <p>Цена: {{ cad.price }} ₽</p>
            {% if cad.slug %}
            <a href="{% url 'myapp:cad_detail' cad.slug %}">Подробнее</a>
            {% else %}
            <p>Детали недоступны</p>
            {% endif %}
        </div>
        {% empty %}
        <p>САПР-системы не найдены.</p>
        {% endfor %}
    </div>
</main>
{% endblock %}